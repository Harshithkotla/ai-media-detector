<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Media Detector</title>
  <link rel="icon" type="image/png" href="assets/logo.png">
  <link rel="stylesheet" href="style.css">
</head>

<body>

<div class="page">

  <!-- ===== TOP BAR ===== -->
  <header class="topbar">
    <div class="brand">
      <img src="assets/logo.png" class="logo" alt="Logo">
      <span>AI Media Detector</span>
    </div>
  </header>

  <!-- ===== MAIN ===== -->
  <main class="main">

    <!-- ===== LEFT INFO ===== -->
    <section class="info">

      <h1>Detect AI-Generated Images</h1>

      <p class="lead">
        Analyze images to estimate whether they are real, AI-generated,
        or visually indistinguishable using modern AI analysis.
      </p>

      <div class="features">
        <span>‚úî Honest AI</span>
        <span>‚úî No Fake 99%</span>
        <span>‚úî Modern AI-safe</span>
      </div>

      <!-- STATS -->
      <div class="stats">
        <div>
          <strong>‚ö° Fast</strong>
          <p>Instant image analysis</p>
        </div>
        <div>
          <strong>üß† AI-Aware</strong>
          <p>Understands modern generators</p>
        </div>
        <div>
          <strong>üîç Transparent</strong>
          <p>No false certainty</p>
        </div>
      </div>

      <!-- WHY SECTION -->
      <div class="how">
        <h3>Why this tool?</h3>
        <p>
          With the rise of powerful image generators, it is becoming
          increasingly difficult to visually distinguish real images
          from AI-generated ones. This tool provides a **risk-based
          estimation**, not blind certainty, and hence declaring as a real image.
        </p>
      </div>

      <!-- HOW IT WORKS -->
      <div class="how">
        <h3>How it works</h3>
        <ol>
          <li>Upload an image</li>
          <li>AI analyzes visual patterns</li>
          <li>Confidence is estimated honestly</li>
        </ol>
      </div>

    </section>

    <!-- ===== RIGHT CARD ===== -->
    <section class="card-wrapper">
      <section class="card">

        <label class="upload-btn" id="uploadLabel">
          Choose Image
          <input type="file" id="fileInput" accept="image/*" hidden onchange="showFileName()">
        </label>

        <p id="fileName" class="file-name hidden"></p>

        <button id="detectBtn" onclick="detectImage()" disabled>
          Detect Image
        </button>

        <div id="preview"></div>

        <div id="result" class="hidden">
          <h3 id="prediction"></h3>
          <p id="confidence"></p>
          <p id="status"></p>
          <p class="note">‚ö†Ô∏è High-quality AI images may appear real.</p>
        </div>

      </section>
    </section>

  </main>

  <!-- ===== FOOTER ===== -->
  <footer class="footer">
    Built with Responsible AI principles ¬∑ Results are probabilistic, not absolute
  </footer>

</div>

<script>
function showFileName() {
  const input = document.getElementById("fileInput");
  const fileNameText = document.getElementById("fileName");
  const uploadLabel = document.getElementById("uploadLabel");
  const detectBtn = document.getElementById("detectBtn");

  if (input.files.length > 0) {
    fileNameText.innerText = "‚úî Selected: " + input.files[0].name;
    fileNameText.classList.remove("hidden");
    uploadLabel.innerText = "Change Image";
    uploadLabel.appendChild(input);
    detectBtn.disabled = false;
  }
}

async function detectImage() {
  const fileInput = document.getElementById("fileInput");
  const file = fileInput.files[0];

  if (!file) {
    alert("Please select an image first");
    return;
  }

  // Preview image
  document.getElementById("preview").innerHTML =
    `<img src="${URL.createObjectURL(file)}" />`;

  const formData = new FormData();
  formData.append("file", file);

  const resultDiv = document.getElementById("result");
  const predictionEl = document.getElementById("prediction");
  const confidenceEl = document.getElementById("confidence");
  const statusEl = document.getElementById("status");

  // Loading state
  resultDiv.classList.remove("hidden");
  predictionEl.innerText = "Analyzing image‚Ä¶ please wait ‚è≥";
  confidenceEl.innerText = "";
  statusEl.innerText = "";

  try {
    const response = await fetch(
      "https://ai-media-detector.onrender.com/detect/image",
      {
        method: "POST",
        body: formData
      }
    );

    if (!response.ok) {
      throw new Error("Server error");
    }

    const data = await response.json();

    predictionEl.innerText = "Prediction: " + data.prediction;
    confidenceEl.innerText =
      `Real: ${data.confidence_real}% | AI: ${data.confidence_ai}%`;
    statusEl.innerText = "Status: " + data.status;

  } catch (err) {
    predictionEl.innerText = "Server is waking up ‚è≥";
    confidenceEl.innerText = "Please try again in 20‚Äì30 seconds";
    statusEl.innerText = "Free backend cold start";
    console.error(err);
  }
}
</script>

</body>
</html>
